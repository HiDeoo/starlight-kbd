---
import config from 'virtual:starlight-kbd/config'

import { parseKbd } from '../libs/kbd'

export type Props = Record<string, string>

const defaultKbd = Astro.props[config.defaultType]

if (!defaultKbd) {
  // TODO(HiDeoo)
  throw new Error(`No default kbd type found in config`)
}
---

<div>KBD</div>

{
  config.types.map((type) => {
    const kbd = parseKbd(Astro.props[type.id] ?? defaultKbd)
    return (
      <div>
        {kbd.map((chord, chordIndex) => {
          // TODO(HiDeoo) chord separator
          // TODO(HiDeoo) chord separator a11y
          return (
            <kbd>
              {chord.map((key, keyIndex) => {
                // TODO(HiDeoo) key separator a11y
                return (
                  <>
                    <kbd>{key}</kbd>
                    {keyIndex < chord.length - 1 && ' + '}
                  </>
                )
              })}
              {chordIndex < kbd.length - 1 && ' | '}
            </kbd>
          )
        })}
      </div>
    )
  })
}
